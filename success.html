<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆåŠŸæ—¥è®° | ç‹‚å®¢Â·é“¶æ²³</title>
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome with fallback -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" 
          onerror="this.onerror=null;this.href='css/fontawesome-fallback.css';">
</head>
<body data-page="success">
    <!-- èƒŒæ™¯è£…é¥° -->
    <div class="bg-decoration">
        <div class="circle circle-1"></div>
        <div class="circle circle-2"></div>
        <div class="circle circle-3"></div>
    </div>
    
    <header class="header">
        <div class="container success-header">
            <div class="header-left">
                <a class="back-link" href="index.html" aria-label="è¿”å›é¦–é¡µ">
                    <i class="fas fa-arrow-left"></i>
                </a>
                <div class="header-text">
                    <div class="title-wrapper">
                        <i class="fas fa-book-open title-icon"></i>
                        <h1 class="logo" data-i18n="successTitle">æˆåŠŸæ—¥è®°æ—¶é—´è½´</h1>
                    </div>
                    <p class="success-subtitle" data-i18n="successSubtitle">
                        <i class="fas fa-quote-left quote-icon"></i>
                        å½“ä½ å†™æˆåŠŸæ—¥è®°çš„æ—¶å€™ï¼Œä½ ä¼šå¯¹è‡ªå·±ï¼Œå¯¹ä¸–ç•Œï¼Œè¿˜æœ‰å¯¹æˆåŠŸçš„è§„å¾‹ä½œæ›´æ·±å…¥çš„æ€è€ƒï¼Œä¼šè¶Šæ¥è¶Šå¤šåœ°äº†è§£è‡ªå·±å’Œè‡ªå·±çš„æ„¿æœ›ï¼Œè¿™æ ·ä½ æ‰ä¼šæœ‰èƒ½åŠ›å»ç†è§£åˆ«äººã€‚å½»åº•äº†è§£è‡ªå·±å’Œä¸–ç•Œä¸Šçš„æ‰€æœ‰ç§˜å¯†ï¼Œæ˜¯æˆ‘ä»¬æ— æ³•å®Œå…¨å®ç°çš„ä¸€ç§ç†æƒ³ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä¸€æ­¥ä¸€æ­¥åœ°æ…¢æ…¢æ¥è¿‘è¿™ç§ç†æƒ³ã€‚ä¸€ä¸ªäººæŒ£é’±çš„å¤šå°‘æ˜¯å’Œä»–çš„è‡ªä¿¡å¿ƒè”ç³»åœ¨ä¸€èµ·çš„ã€‚å¦å¤–,ä»–çš„ç²¾åŠ›ç©¶ç«Ÿæ˜¯é›†ä¸­åœ¨è‡ªå·±çš„èƒ½åŠ›èŒƒå›´ä¹‹å†…,è¿˜æ˜¯æ”¾åˆ°äº†ä»–åŠ›æ‰€ä¸èƒ½åŠçš„äº‹æƒ…ä¸Š,è¿™ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ä¸€ç‚¹ã€‚æ²¡æœ‰æˆ‘çš„æˆåŠŸæ—¥è®°æœ¬,æˆ‘å°±ä¸ä¼šå»æ€è€ƒè‡ªå·±é€‚åˆåœ¨å“ªäº›æ–¹é¢èµšé’±ã€‚
                        <i class="fas fa-quote-right quote-icon"></i>
                    </p>
                </div>
            </div>
            <div class="controls success-controls">
                <div class="search-box diary-search">
                    <i class="fas fa-search"></i>
                    <input type="text" id="diarySearchInput" placeholder="æœç´¢æ ‡é¢˜ã€æ ‡ç­¾ã€å¿ƒæƒ…..." aria-label="æœç´¢æ—¥è®°">
                    <button class="search-clear" id="searchClear" style="display: none;" aria-label="æ¸…é™¤æœç´¢">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <button id="languageToggle" class="language-toggle" aria-label="åˆ‡æ¢è¯­è¨€">
                    <i class="fas fa-language"></i>
                    <span>ä¸­ â†’ EN</span>
                </button>
                <button id="themeToggle" class="theme-toggle" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </header>
    
    <section class="diary-toolbar" role="region" aria-label="æ—¥è®°ç­›é€‰å·¥å…·æ ">
        <div class="container diary-toolbar-inner">
            <div class="filter-group">
                <div class="filter-header">
                    <i class="fas fa-tags"></i>
                    <span class="filter-title" data-i18n="tagLabel">åˆ†ç±»æ ‡ç­¾</span>
                </div>
                <div id="diaryTagFilter" class="filter-chips" role="group" aria-label="æ ‡ç­¾ç­›é€‰"></div>
            </div>
            <div class="filter-row">
                <div class="filter-item">
                    <i class="fas fa-smile"></i>
                    <label class="filter-label" data-i18n="moodLabel" for="diaryMoodSelect">å¿ƒæƒ…</label>
                    <select id="diaryMoodSelect" class="filter-select" aria-label="é€‰æ‹©å¿ƒæƒ…ç­›é€‰">
                        <option value="all">å…¨éƒ¨å¿ƒæƒ…</option>
                    </select>
                </div>
                <div class="filter-item">
                    <i class="fas fa-sort"></i>
                    <label class="filter-label" data-i18n="sortLabel" for="diarySortSelect">æ’åº</label>
                    <select id="diarySortSelect" class="filter-select" aria-label="é€‰æ‹©æ’åºæ–¹å¼">
                        <option value="dateDesc">ğŸ“… æ—¥æœŸï¼šæœ€æ–°ä¼˜å…ˆ</option>
                        <option value="dateAsc">ğŸ“… æ—¥æœŸï¼šæœ€æ—§ä¼˜å…ˆ</option>
                        <option value="achievementDesc">ğŸ† æˆå°±å€¼ï¼šæœ€é«˜ä¼˜å…ˆ</option>
                        <option value="achievementAsc">ğŸ† æˆå°±å€¼ï¼šæœ€ä½ä¼˜å…ˆ</option>
                    </select>
                </div>
                <button id="diaryResetFilters" class="ghost-btn reset-btn" data-i18n="resetFilters" aria-label="é‡ç½®æ‰€æœ‰ç­›é€‰æ¡ä»¶">
                    <i class="fas fa-redo"></i>
                    <span>é‡ç½®ç­›é€‰</span>
                </button>
            </div>
        </div>
    </section>
    
    <main class="main-content success-main">
        <div class="container">
            <div class="stats-bar">
                <div class="diary-counter" id="diaryCounter">
                    <i class="fas fa-chart-line"></i>
                    <span>å…± <strong>0</strong> æ¡è®°å½•</span>
                </div>
                <div class="view-toggle" role="group" aria-label="åˆ‡æ¢è§†å›¾">
                    <button class="view-btn active" data-view="timeline" aria-label="æ—¶é—´è½´è§†å›¾" aria-pressed="true">
                        <i class="fas fa-stream"></i>
                    </button>
                    <button class="view-btn" data-view="grid" aria-label="ç½‘æ ¼è§†å›¾" aria-pressed="false">
                        <i class="fas fa-th"></i>
                    </button>
                </div>
            </div>
            
            <div id="diaryTimeline" class="timeline"></div>
            
            <!-- ç©ºçŠ¶æ€ -->
            <div class="empty-state hidden">
                <i class="fas fa-search empty-icon"></i>
                <h3>æœªæ‰¾åˆ°åŒ¹é…çš„è®°å½•</h3>
                <p>è¯•è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æœç´¢å…³é”®è¯</p>
            </div>
        </div>
    </main>
    
    <!-- è¿”å›é¡¶éƒ¨æŒ‰é’® -->
    <button id="backToTop" class="back-to-top" aria-label="è¿”å›é¡¶éƒ¨">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <script src="data.js" ></script>
    <script src="script.js" ></script>
</body>
</html>
// æ¸²æŸ“å•ä¸ªæ—¥è®°å¡ç‰‡
function renderDiaryCard(diary, lang) {
    const currentLang = lang || getCurrentLanguage();
    const moodInfo = getMoodInfo(diary.moodCode, currentLang);
    
    return `
        <div class="timeline-item" data-id="${diary.id}">
            <div class="timeline-marker"></div>
            <div class="timeline-card">
                <div class="diary-card-body">
                    ${diary.coverImage ? `
                        <img src="${diary.coverImage}" 
                             alt="${diary.headline[currentLang]}" 
                             class="diary-cover">
                    ` : ''}
                    
                    <div class="diary-card-content" data-lang="${currentLang}">
                        <div class="diary-card-header" data-lang="${currentLang}">
                            <h2 class="diary-title" data-lang="${currentLang}">
                                ${diary.headline[currentLang]}
                            </h2>
                            <div class="diary-date">
                                <i class="fas fa-calendar-alt"></i>
                                ${formatDate(diary.date, currentLang)}
                            </div>
                        </div>
                        
                        <div class="diary-text" data-lang="${currentLang}">
                            ${formatContent(diary.content[currentLang])}
                        </div>
                        
                        ${diary.highlight && diary.highlight[currentLang] ? `
                            <div class="diary-highlight" data-lang="${currentLang}">
                                <strong class="meta-title">
                                    ${currentLang === 'zh' ? 'å°ç»“:' : 'Highlight:'}
                                </strong>
                                <span class="highlight-content">${diary.highlight[currentLang]}</span>
                            </div>
                        ` : ''}
                        
                        ${diary.notes && diary.notes[currentLang] ? `
                            <div class="diary-notes" data-lang="${currentLang}">
                                <strong class="meta-title">
                                    ${currentLang === 'zh' ? 'å¤‡æ³¨:' : 'Notes:'}
                                </strong>
                                <p>${diary.notes[currentLang]}</p>
                            </div>
                        ` : ''}
                        
                        <div class="diary-meta">
                            <div>
                                <span class="meta-title">
                                    ${currentLang === 'zh' ? 'æ ‡ç­¾:' : 'Tags:'}
                                </span>
                                <span class="meta-content">
                                    ${diary.categories.map(cat => 
                                        `<span class="tag-pill">${getTagName(cat, currentLang)}</span>`
                                    ).join('')}
                                </span>
                            </div>
                            
                            <div>
                                <span class="meta-title">
                                    ${currentLang === 'zh' ? 'å¿ƒæƒ…:' : 'Mood:'}
                                </span>
                                <span class="meta-content">
                                    <span class="mood-badge" style="color: ${moodInfo.color}; border-color: ${moodInfo.color};">
                                        ${moodInfo.emoji} ${moodInfo.text}
                                    </span>
                                </span>
                            </div>
                            
                            <div>
                                <span class="meta-title">
                                    ${currentLang === 'zh' ? 'æˆå°±:' : 'Achievement:'}
                                </span>
                                <span class="meta-content">
                                    <span class="achievement-badge">
                                        ${'â˜…'.repeat(diary.achievementLevel)}${'â˜†'.repeat(5 - diary.achievementLevel)}
                                    </span>
                                </span>
                            </div>
                        </div>
                        
                        ${diary.attachments && diary.attachments.length > 0 ? `
                            <div class="diary-attachments">
                                <span class="meta-title">
                                    ${currentLang === 'zh' ? 'é™„ä»¶:' : 'Attachments:'}
                                </span>
                                ${diary.attachments.map(att => 
                                    att.type === 'image' 
                                        ? `<img src="${att.url}" alt="${att.name}" class="diary-attachment">`
                                        : `<a href="${att.url}" class="diary-attachment-link" target="_blank">
                                            <i class="fas fa-paperclip"></i> ${att.name}
                                           </a>`
                                ).join('')}
                            </div>
                        ` : ''}
                    </div>
                </div>
            </div>
        </div>
    `;
}

// æ ¼å¼åŒ–å†…å®¹(ä¿æŒæ¢è¡Œ)
function formatContent(content) {
    if (!content) return '';
    return content.split('\n').map(line => 
        line.trim() ? `<p>${line}</p>` : ''
    ).join('');
}

// åˆ‡æ¢è¯­è¨€æ—¶é‡æ–°æ¸²æŸ“
function switchLanguage() {
    const newLang = getCurrentLanguage() === 'zh' ? 'en' : 'zh';
    setCurrentLanguage(newLang);
    
    // æ›´æ–°æŒ‰é’®æ–‡æœ¬
    const langBtn = document.querySelector('.language-toggle');
    if (langBtn) {
        langBtn.innerHTML = `
            <i class="fas fa-language"></i>
            <span>${newLang === 'zh' ? 'ä¸­ â†’ EN' : 'EN â†’ ä¸­'}</span>
        `;
    }
    
    // é‡æ–°æ¸²æŸ“æ‰€æœ‰å†…å®¹
    renderAllDiaries();
}

// è·å–å½“å‰è¯­è¨€
function getCurrentLanguage() {
    return localStorage.getItem('language') || 'zh';
}

// è®¾ç½®å½“å‰è¯­è¨€
function setCurrentLanguage(lang) {
    localStorage.setItem('language', lang);
}

// æ¸²æŸ“æ‰€æœ‰æ—¥è®°
function renderAllDiaries() {
    const currentLang = getCurrentLanguage();
    const timeline = document.querySelector('.timeline');
    
    if (!timeline) return;
    
    const filteredDiaries = getFilteredDiaries();
    
    if (filteredDiaries.length === 0) {
        timeline.innerHTML = `
            <div class="diary-empty">
                <div class="empty-icon">ğŸ“</div>
                <h3>${currentLang === 'zh' ? 'æš‚æ— æ—¥è®°' : 'No Diaries Yet'}</h3>
                <p>${currentLang === 'zh' ? 'å¼€å§‹è®°å½•ä½ çš„æˆåŠŸæ—¶åˆ»å§!' : 'Start recording your success moments!'}</p>
            </div>
        `;
        return;
    }
    
    timeline.innerHTML = filteredDiaries
        .map(diary => renderDiaryCard(diary, currentLang))
        .join('');
}

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    // è®¾ç½®åˆå§‹è¯­è¨€
    const currentLang = getCurrentLanguage();
    
    // æ¸²æŸ“æ—¥è®°
    renderAllDiaries();
    
    // ç»‘å®šè¯­è¨€åˆ‡æ¢æŒ‰é’®
    const langBtn = document.querySelector('.language-toggle');
    if (langBtn) {
        langBtn.addEventListener('click', switchLanguage);
    }
});
