<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>日记数据测试</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #1a1a2e;
            color: white;
        }
        .test-item { 
            margin: 15px 0; 
            padding: 15px; 
            background: #16213e; 
            border-radius: 8px;
            border-left: 4px solid #0f3460;
        }
        .success { border-left-color: #10b981; }
        .error { border-left-color: #ef4444; }
        pre { 
            background: #0f0f1e; 
            padding: 10px; 
            border-radius: 4px; 
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>🔍 成功日记数据加载测试</h1>
    <div id="results"></div>

    <script src="data.js"></script>
    <script>
        const results = document.getElementById('results');
        
        function addTest(title, status, content) {
            const div = document.createElement('div');
            div.className = `test-item ${status}`;
            div.innerHTML = `
                <h3>${status === 'success' ? '✅' : '❌'} ${title}</h3>
                ${content ? `<pre>${content}</pre>` : ''}
            `;
            results.appendChild(div);
        }

        // 测试1：检查变量是否定义
        if (typeof successDiaryData !== 'undefined') {
            addTest('successDiaryData 已定义', 'success', `长度: ${successDiaryData.length}`);
        } else {
            addTest('successDiaryData 未定义', 'error', '变量不存在');
        }

        // 测试2：检查是否暴露到window
        if (typeof window.successDiaryData !== 'undefined') {
            addTest('window.successDiaryData 已暴露', 'success', `长度: ${window.successDiaryData.length}`);
        } else {
            addTest('window.successDiaryData 未暴露', 'error', '需要在data.js中添加 window.successDiaryData = successDiaryData');
        }

        // 测试3：检查数据结构
        if (window.successDiaryData && window.successDiaryData.length > 0) {
            const first = window.successDiaryData[0];
            addTest('数据结构检查', 'success', JSON.stringify(first, null, 2));
        } else {
            addTest('数据结构检查', 'error', '数据为空或不存在');
        }

        // 测试4：检查其他必需变量
        const vars = {
            'diaryTagLibrary': window.diaryTagLibrary,
            'moodLibrary': window.moodLibrary,
            'momentsData': window.momentsData
        };
        
        Object.entries(vars).forEach(([name, value]) => {
            if (value) {
                const length = Array.isArray(value) ? value.length : Object.keys(value).length;
                addTest(`${name} 已加载`, 'success', `包含 ${length} 项`);
            } else {
                addTest(`${name} 未加载`, 'error');
            }
        });

        // 测试5：尝试手动渲染
        console.log('=== 完整测试数据 ===');
        console.log('successDiaryData:', window.successDiaryData);
        console.log('diaryTagLibrary:', window.diaryTagLibrary);
        console.log('moodLibrary:', window.moodLibrary);
    </script>
</body>
</html>
