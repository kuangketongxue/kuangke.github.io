<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- åŸºç¡€Metaæ ‡ç­¾ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEOä¼˜åŒ– -->
    <meta name="description" content="ç‹‚å®¢Â·é“¶æ²³ - è®°å½•ç”Ÿæ´»ç²¾å½©ç¬é—´ï¼Œåˆ†äº«ç¾å¥½æ—¶åˆ»">
    <meta name="keywords" content="ç‹‚å®¢,é“¶æ²³,æœ‹å‹åœˆ,ç”Ÿæ´»åˆ†äº«,æˆåŠŸæ—¥è®°">
    <meta name="author" content="ç‹‚å®¢">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / ç¤¾äº¤åª’ä½“åˆ†äº« -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ç‹‚å®¢Â·é“¶æ²³">
    <meta property="og:description" content="è®°å½•ç”Ÿæ´»ç²¾å½©ç¬é—´ï¼Œåˆ†äº«ç¾å¥½æ—¶åˆ»">
    <meta property="og:site_name" content="ç‹‚å®¢Â·é“¶æ²³">
    
    <!-- ç½‘ç«™å›¾æ ‡ -->
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="images/favicon.ico">
    
    <!-- é¢„è¿æ¥å¤–éƒ¨èµ„æº -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    
    <title>ç‹‚å®¢Â·é“¶æ²³ - è®°å½•ç”Ÿæ´»ç²¾å½©ç¬é—´</title>
    
    <!-- æ ·å¼è¡¨ -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous">
  
    <style>
        /* ==================== AIå‰æ²¿æŒ‰é’®ä¸“å±æ ·å¼ ==================== */
        .ai-nav-button {
            display: inline-flex;
            align-items: center;
            padding: 10px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
            will-change: transform, box-shadow;
        }

        /* å…‰æ³½æ•ˆæœ */
        .ai-nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent
            );
            transition: left 0.5s ease;
        }

        .ai-nav-button:hover::before {
            left: 100%;
        }

        /* æ‚¬åœæ•ˆæœ */
        .ai-nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        /* ç‚¹å‡»æ•ˆæœ */
        .ai-nav-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        /* å›¾æ ‡æ ·å¼ */
        .ai-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            margin-right: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .ai-nav-button:hover .ai-icon {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1) rotate(5deg);
        }

        /* å‘¼å¸å…‰æ™•åŠ¨ç”» */
        @keyframes ai-glow {
            0%, 100% { 
                box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); 
            }
            50% { 
                box-shadow: 0 4px 20px rgba(102, 126, 234, 0.6),
                            0 0 30px rgba(102, 126, 234, 0.2); 
            }
        }

        .ai-nav-button {
            animation: ai-glow 3s ease-in-out infinite;
        }

        /* ==================== å¥åº·æé†’æŒ‰é’®ä¸“å±æ ·å¼ ==================== */
        .health-nav-button {
            display: inline-flex;
            align-items: center;
            padding: 10px 16px;
            background: linear-gradient(135deg, #00c9a7 0%, #8b5cf6 100%);
            color: #fff;
            border: none;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(0, 201, 167, 0.3);
            position: relative;
            overflow: hidden;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
            will-change: transform, box-shadow;
            margin-left: 10px;
            cursor: pointer;
        }

        /* å¥åº·æé†’æŒ‰é’®å…‰æ³½æ•ˆæœ */
        .health-nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.3), 
                transparent
            );
            transition: left 0.5s ease;
        }

        .health-nav-button:hover::before {
            left: 100%;
        }

        /* å¥åº·æé†’æŒ‰é’®æ‚¬åœæ•ˆæœ */
        .health-nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 201, 167, 0.4);
            background: linear-gradient(135deg, #8b5cf6 0%, #00c9a7 100%);
        }

        /* å¥åº·æé†’æŒ‰é’®ç‚¹å‡»æ•ˆæœ */
        .health-nav-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 201, 167, 0.3);
        }

        /* å¥åº·æé†’å›¾æ ‡æ ·å¼ */
        .health-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            margin-right: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .health-nav-button:hover .health-icon {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1) rotate(5deg);
        }

        /* å¥åº·æé†’å‘¼å¸å…‰æ™•åŠ¨ç”» */
        @keyframes health-glow {
            0%, 100% { 
                box-shadow: 0 4px 12px rgba(0, 201, 167, 0.3); 
            }
            50% { 
                box-shadow: 0 4px 20px rgba(0, 201, 167, 0.6),
                            0 0 30px rgba(0, 201, 167, 0.2); 
            }
        }

        .health-nav-button {
            animation: health-glow 3s ease-in-out infinite;
        }

        /* å¥åº·æé†’æ¿€æ´»çŠ¶æ€ */
        .health-nav-button.active {
            background: linear-gradient(135deg, #10b981 0%, #3b82f6 100%);
            animation: none;
        }

        .health-nav-button.active::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #10b981, #3b82f6, #10b981);
            border-radius: 12px;
            z-index: -1;
            animation: health-rotate 3s linear infinite;
        }

        @keyframes health-rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ==================== å¥åº·æé†’é€šçŸ¥æ ·å¼ ==================== */
        .health-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 9999;
            display: none;
            max-width: 400px;
            transform: translateX(450px);
            transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .health-notification.show {
            display: block;
            transform: translateX(0);
        }

        .health-notification.eye-care {
            background: linear-gradient(135deg, #00c9a7 0%, #8b5cf6 100%);
        }

        .health-notification.break {
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .notification-title {
            font-weight: 700;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification-icon {
            width: 28px;
            height: 28px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .notification-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            cursor: pointer;
            font-size: 20px;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .notification-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .notification-content {
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 15px;
        }

        .notification-timer {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 15px;
            text-align: center;
        }

        .timer-display {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .timer-label {
            font-size: 14px;
            opacity: 0.9;
        }

        .eye-care-steps {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        .eye-care-steps h4 {
            margin-bottom: 10px;
            font-size: 16px;
        }

        .eye-care-steps ol {
            margin: 0;
            padding-left: 20px;
            font-size: 14px;
            line-height: 1.8;
        }

        .audio-controls {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .audio-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .audio-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .audio-btn.playing {
            background: rgba(255, 255, 255, 0.4);
            animation: audio-pulse 2s infinite;
        }

        @keyframes audio-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .audio-info {
            flex: 1;
        }

        .audio-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .audio-status {
            font-size: 12px;
            opacity: 0.8;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .volume-slider {
            width: 80px;
            height: 4px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 2px;
            outline: none;
            cursor: pointer;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            cursor: pointer;
        }

        .notification-actions {
            display: flex;
            gap: 10px;
        }

        .notification-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .notification-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.3s, height 0.3s;
        }

        .notification-btn:active::before {
            width: 300px;
            height: 300px;
        }

        .notification-btn.primary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .notification-btn.primary:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .notification-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }

        .notification-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .notification-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* åå°æƒé™æç¤º */
        .permission-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            padding: 15px 20px;
            display: none;
            align-items: center;
            justify-content: space-between;
            z-index: 10000;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.2);
        }

        .permission-banner.show {
            display: flex;
        }

        .permission-content {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
        }

        .permission-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .permission-text h4 {
            margin: 0 0 5px 0;
            font-size: 16px;
        }

        .permission-text p {
            margin: 0;
            font-size: 14px;
            opacity: 0.9;
        }

        .permission-actions {
            display: flex;
            gap: 10px;
        }

        .permission-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .permission-btn.allow {
            background: white;
            color: #1e40af;
        }

        .permission-btn.allow:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.3);
        }

        .permission-btn.deny {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .permission-btn.deny:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* å“åº”å¼ä¼˜åŒ– */
        @media (max-width: 768px) {
            .ai-nav-button, .health-nav-button {
                padding: 8px 12px;
                font-size: 13px;
            }
            
            .ai-icon, .health-icon {
                width: 20px;
                height: 20px;
                margin-right: 6px;
            }

            .health-notification {
                right: 10px;
                left: 10px;
                max-width: none;
                transform: translateY(-100px);
            }

            .health-notification.show {
                transform: translateY(0);
            }

            .notification-title {
                font-size: 16px;
            }

            .timer-display {
                font-size: 20px;
            }

            .permission-banner {
                flex-direction: column;
                gap: 15px;
            }

            .permission-content {
                flex-direction: column;
                text-align: center;
            }

            .permission-actions {
                width: 100%;
            }

            .permission-btn {
                flex: 1;
            }
        }

        /* å‡å°‘åŠ¨ç”»æ•ˆæœï¼ˆå°Šé‡ç”¨æˆ·åå¥½ï¼‰ */
        @media (prefers-reduced-motion: reduce) {
            .ai-nav-button, .health-nav-button {
                animation: none;
                transition: none;
            }
            
            .ai-nav-button::before, .health-nav-button::before {
                transition: none;
            }

            .health-notification {
                transition: none;
            }

            .health-nav-button.active::after {
                animation: none;
            }

            .audio-btn.playing {
                animation: none;
            }
        }

        /* ==================== é¡µé¢åŠ è½½ä¼˜åŒ– ==================== */
        /* éª¨æ¶å±æ ·å¼ */
        .skeleton {
            background: linear-gradient(
                90deg,
                #f0f0f0 25%,
                #e0e0e0 50%,
                #f0f0f0 75%
            );
            background-size: 200% 100%;
            animation: loading 1.5s ease-in-out infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* æ·±è‰²æ¨¡å¼ä¼˜åŒ– */
        @media (prefers-color-scheme: dark) {
            .skeleton {
                background: linear-gradient(
                    90deg,
                    #2a2a2a 25%,
                    #3a3a3a 50%,
                    #2a2a2a 75%
                );
            }
        }
    </style>
</head>

<body data-page="moments">
    <!-- ==================== é¡¶éƒ¨å¯¼èˆªæ  ==================== -->
    <header class="header" role="banner">
        <div class="container">
            <div class="header-left">
                <!-- Logo -->
                <h1 class="logo">
                    <a href="index.html" aria-label="è¿”å›é¦–é¡µ">ç‹‚å®¢Â·é“¶æ²³</a>
                </h1>

                <!-- å¯¼èˆªé“¾æ¥ -->
                <nav class="primary-nav" role="navigation" aria-label="ä¸»å¯¼èˆª">
                    <!-- æˆåŠŸæ—¥è®° -->
                    <a class="success-link" href="success.html" title="æŸ¥çœ‹æˆåŠŸæ—¥è®°">
                        <span class="success-icon" aria-hidden="true">
                            <i class="fas fa-meteor"></i>
                        </span>
                        <span class="success-text">æˆåŠŸæ—¥è®°</span>
                    </a>

                    <!-- æ˜Ÿç©º -->
                    <a class="sky-link" href="reading.html" title="æ¢ç´¢æ˜Ÿç©º">
                        <span class="sky-icon" aria-hidden="true">
                            <i class="fas fa-star"></i>
                        </span>
                        <span class="sky-text">æ˜Ÿç©º</span>
                    </a>

                    <!-- å†¬ä¹‹è¡—å°åº— -->
                    <a class="exam-link" 
                       href="https://kuangketongxue.github.io/tongxuekuangke/" 
                       target="_blank" 
                       rel="noopener noreferrer"
                       title="è®¿é—®å†¬ä¹‹è¡—å°åº—">
                        <span class="exam-icon" aria-hidden="true">
                            <i class="fas fa-graduation-cap"></i>
                        </span>
                        <span class="exam-text">å†¬ä¹‹è¡—å°åº—</span>
                    </a>

                    <!-- è§†é¢‘çŸ©é˜µ -->
                    <a class="video-link" href="video.html" title="è§‚çœ‹è§†é¢‘å†…å®¹">
                        <span class="video-icon" aria-hidden="true">
                            <i class="fas fa-video"></i>
                        </span>
                        <span class="video-text">è§†é¢‘çŸ©é˜µ</span>
                    </a>
                </nav>
            </div>

            <!-- å³ä¾§æ§åˆ¶åŒº -->
            <div class="controls">
                <!-- AIå‰æ²¿æŒ‰é’® -->
                <a href="ai.html" class="ai-nav-button">
                    <span class="ai-icon">
                        <i class="fas fa-brain"></i>
                    </span>
                    <span>AIå‰æ²¿</span>
                </a>

                <!-- å¥åº·æé†’æŒ‰é’® -->
                <button id="healthReminderBtn" class="health-nav-button">
                    <span class="health-icon">
                        <i class="fas fa-heartbeat"></i>
                    </span>
                    <span>å¥åº·æé†’</span>
                </button>

                <!-- æœç´¢æ¡† -->
                <div class="search-box" role="search">
                    <label for="searchInput" class="sr-only">æœç´¢å†…å®¹</label>
                    <i class="fas fa-search" aria-hidden="true"></i>
                    <input 
                        type="search" 
                        id="searchInput" 
                        placeholder="æœç´¢é“¶æ²³ä¸­..."
                        autocomplete="off"
                        aria-label="æœç´¢æœ‹å‹åœˆå†…å®¹">
                </div>

                <!-- ä¸»é¢˜åˆ‡æ¢ -->
                <button 
                    id="themeToggle" 
                    class="theme-toggle" 
                    aria-label="åˆ‡æ¢æ·±è‰²/æµ…è‰²ä¸»é¢˜"
                    title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-moon" aria-hidden="true"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- ==================== åˆ†ç±»å¯¼èˆª ==================== -->
    <nav class="category-nav" role="navigation" aria-label="å†…å®¹åˆ†ç±»">
        <div class="container">
            <div class="category-scroll" role="tablist">
                <button class="category-btn active" data-category="all" role="tab" aria-selected="true">
                    å…¨éƒ¨
                </button>
                <button class="category-btn" data-category="ç”Ÿæ´»æ—¥å¸¸" role="tab">ç”Ÿæ´»æ—¥å¸¸</button>
                <button class="category-btn" data-category="ç¾é£Ÿåˆ†äº«" role="tab">ç¾é£Ÿåˆ†äº«</button>
                <button class="category-btn" data-category="æ—…è¡Œè§é—»" role="tab">æ—…è¡Œè§é—»</button>
                <button class="category-btn" data-category="å·¥ä½œç›¸å…³" role="tab">å·¥ä½œç›¸å…³</button>
                <button class="category-btn" data-category="å­¦ä¹ æˆé•¿" role="tab">å­¦ä¹ æˆé•¿</button>
                <button class="category-btn" data-category="å¥èº«è¿åŠ¨" role="tab">å¥èº«è¿åŠ¨</button>
                <button class="category-btn" data-category="æ—¶å°šç©¿æ­" role="tab">æ—¶å°šç©¿æ­</button>
                <button class="category-btn" data-category="è‰ºæœ¯æ–‡åŒ–" role="tab">è‰ºæœ¯æ–‡åŒ–</button>
                <button class="category-btn" data-category="æƒ…æ„Ÿè¡¨è¾¾" role="tab">æƒ…æ„Ÿè¡¨è¾¾</button>
                <button class="category-btn" data-category="èŠ‚æ—¥çºªå¿µ" role="tab">èŠ‚æ—¥çºªå¿µ</button>
                <button class="category-btn" data-category="å…¬ç›Šç¯ä¿" role="tab">å…¬ç›Šç¯ä¿</button>
                <button class="category-btn" data-category="ç§‘æŠ€æ•°ç " role="tab">ç§‘æŠ€æ•°ç </button>
                <button class="category-btn" data-category="è´¢ç»ç†è´¢" role="tab">è´¢ç»ç†è´¢</button>
                <button class="category-btn" data-category="å¹½é»˜æ®µå­" role="tab">å¹½é»˜æ®µå­</button>
                <button class="category-btn" data-category="é—®ç­”äº’åŠ¨" role="tab">é—®ç­”äº’åŠ¨</button>
            </div>
        </div>
    </nav>

    <!-- ==================== ä¸»è¦å†…å®¹åŒºåŸŸ ==================== -->
    <main class="main-content" role="main">
        <div class="container">
            <!-- ç»Ÿè®¡ä¿¡æ¯å¡ç‰‡ -->
            <section class="moments-stats" aria-label="æœ‹å‹åœˆç»Ÿè®¡">
                <div class="stat-cards">
                    <article class="stat-card">
                        <div class="stat-number" id="totalMoments" aria-live="polite">0</div>
                        <div class="stat-label">æœ‹å‹åœˆæ€»æ•°</div>
                    </article>
                    
                    <article class="stat-card highlight">
                        <div class="stat-number" id="highValueMoments" aria-live="polite">0</div>
                        <div class="stat-label">é«˜ä»·å€¼å†…å®¹</div>
                    </article>
                    
                    <article class="stat-card">
                        <div class="stat-number" id="todayMoments" aria-live="polite">0</div>
                        <div class="stat-label">ä»Šæ—¥å‘å¸ƒ</div>
                    </article>
                </div>
            </section>

            <!-- æœ‹å‹åœˆå†…å®¹åˆ—è¡¨ -->
            <section 
                id="momentsContainer" 
                class="moments-grid" 
                role="feed"
                aria-label="æœ‹å‹åœˆå†…å®¹åˆ—è¡¨"
                aria-live="polite"
                aria-busy="false">
                <!-- å†…å®¹ç”±JavaScriptåŠ¨æ€åŠ è½½ -->
            </section>
            
            <!-- ==================== åˆ†é¡µæ§ä»¶ ==================== -->
            <nav class="pagination-container" role="navigation" aria-label="åˆ†é¡µå¯¼èˆª">
                <div class="pagination-info">
                    <span id="paginationText" aria-live="polite">
                        æ˜¾ç¤º <strong id="showingStart">0</strong> - <strong id="showingEnd">0</strong> 
                        å…± <strong id="totalItems">0</strong> æ¡
                    </span>
                </div>
                <div class="pagination-controls">
                    <button 
                        id="firstPage" 
                        class="pagination-btn" 
                        aria-label="ç¬¬ä¸€é¡µ"
                        title="ç¬¬ä¸€é¡µ">
                        <i class="fas fa-angle-double-left"></i>
                    </button>
                    <button 
                        id="prevPage" 
                        class="pagination-btn" 
                        aria-label="ä¸Šä¸€é¡µ"
                        title="ä¸Šä¸€é¡µ">
                        <i class="fas fa-angle-left"></i>
                    </button>
                    
                    <div id="pageNumbers" class="page-numbers" role="list">
                        <!-- é¡µç ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    
                    <button 
                        id="nextPage" 
                        class="pagination-btn" 
                        aria-label="ä¸‹ä¸€é¡µ"
                        title="ä¸‹ä¸€é¡µ">
                        <i class="fas fa-angle-right"></i>
                    </button>
                    <button 
                        id="lastPage" 
                        class="pagination-btn" 
                        aria-label="æœ€åä¸€é¡µ"
                        title="æœ€åä¸€é¡µ">
                        <i class="fas fa-angle-double-right"></i>
                    </button>
                </div>
                <div class="pagination-settings">
                    <label for="itemsPerPage">æ¯é¡µæ˜¾ç¤ºï¼š</label>
                    <select id="itemsPerPage" aria-label="é€‰æ‹©æ¯é¡µæ˜¾ç¤ºæ¡æ•°">
                        <option value="6">6æ¡</option>
                        <option value="12" selected>12æ¡</option>
                        <option value="24">24æ¡</option>
                        <option value="48">48æ¡</option>
                    </select>
                </div>
            </nav>
        </div>
    </main>

    <!-- ==================== é¡µé¢åº•éƒ¨ ==================== -->
    <footer class="social-footer" role="contentinfo">
        <div class="container">
            <!-- ç¤¾äº¤åª’ä½“é“¾æ¥ -->
            <nav class="social-links" aria-label="ç¤¾äº¤åª’ä½“">
                <a href="https://open.weixin.qq.com/qr/code?username=gh_ba5b6bb6bd89" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="social-link wechat" 
                   title="å…³æ³¨å¾®ä¿¡å…¬ä¼—å·"
                   aria-label="å¾®ä¿¡å…¬ä¼—å·">
                    <i class="fab fa-weixin" aria-hidden="true"></i>
                </a>
                
                <a href="https://github.com/kuangketongxue" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="social-link github" 
                   title="è®¿é—®GitHub"
                   aria-label="GitHubä¸»é¡µ">
                    <i class="fab fa-github" aria-hidden="true"></i>
                </a>
                
                <a href="https://x.com/kuangketongxue" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="social-link x" 
                   title="å…³æ³¨X(Twitter)"
                   aria-label="Xè´¦å·">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                        <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                    </svg>
                </a>
            </nav>

            <!-- ç‰ˆæƒä¿¡æ¯ -->
            <p class="copyright">
                <small>Â© 2025 ç‹‚å®¢Â·é“¶æ²³ ç‰ˆæƒæ‰€æœ‰</small>
            </p>
        </div>
    </footer>

    <!-- ==================== è¯„è®ºæ¨¡æ€æ¡† ==================== -->
    <div id="commentModal" 
         class="modal" 
         role="dialog" 
         aria-labelledby="modalTitle"
         aria-modal="true"
         aria-hidden="true">
        <div class="modal-content">
            <button class="close" 
                    aria-label="å…³é—­è¯„è®ºçª—å£"
                    title="å…³é—­">
                <span aria-hidden="true">&times;</span>
            </button>
            
            <h2 id="modalTitle">è¯„è®º</h2>
            
            <div id="commentsList" 
                 class="comments-list" 
                 role="list"
                 aria-label="è¯„è®ºåˆ—è¡¨">
                <!-- è¯„è®ºå†…å®¹ç”±JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
            
            <div class="comment-input-area">
                <label for="commentInput" class="sr-only">è¾“å…¥è¯„è®º</label>
                <input 
                    type="text" 
                    id="commentInput" 
                    placeholder="å†™ä¸‹ä½ çš„è¯„è®º..."
                    maxlength="500"
                    aria-label="è¯„è®ºè¾“å…¥æ¡†">
                <button id="submitComment" aria-label="å‘é€è¯„è®º">å‘é€</button>
            </div>
        </div>
    </div>

    <!-- ==================== å¥åº·æé†’é€šçŸ¥ ==================== -->
    <div id="healthNotification" class="health-notification">
        <div class="notification-header">
            <div class="notification-title" id="notificationTitle">
                <div class="notification-icon">
                    <i class="fas fa-heartbeat"></i>
                </div>
                <span>å¥åº·æé†’</span>
            </div>
            <button class="notification-close" id="notificationClose" title="å…³é—­é€šçŸ¥">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notification-content" id="notificationContent">
            <!-- åŠ¨æ€å†…å®¹ -->
        </div>
        <div class="notification-actions">
            <button class="notification-btn primary" id="notificationConfirm">
                <i class="fas fa-check"></i> ç¡®è®¤å®Œæˆ
            </button>
            <button class="notification-btn secondary" id="notificationSnooze">
                <i class="fas fa-clock"></i> ç¨åæé†’
            </button>
        </div>
    </div>

    <!-- ==================== æƒé™è¯·æ±‚æ¨ªå¹… ==================== -->
    <div id="permissionBanner" class="permission-banner">
        <div class="permission-content">
            <div class="permission-icon">
                <i class="fas fa-bell"></i>
            </div>
            <div class="permission-text">
                <h4>å¼€å¯åå°æé†’</h4>
                <p>å…è®¸å¥åº·æé†’åœ¨åå°è¿è¡Œï¼Œå³ä½¿åœ¨æ‚¨ç¦»å¼€é¡µé¢æ—¶ä¹Ÿèƒ½åŠæ—¶æé†’æ‚¨</p>
            </div>
        </div>
        <div class="permission-actions">
            <button class="permission-btn allow" id="allowBackgroundBtn">å…è®¸</button>
            <button class="permission-btn deny" id="denyBackgroundBtn">æš‚ä¸</button>
        </div>
    </div>

    <!-- æ— éšœç¢ï¼šå±å¹•é˜…è¯»å™¨ä¸“ç”¨æ–‡æœ¬ -->
    <div class="sr-only" aria-live="polite" aria-atomic="true" id="announcer"></div>

    <!-- ==================== JavaScriptæ–‡ä»¶ ==================== -->
    <!-- æ•°æ®æ–‡ä»¶ä¼˜å…ˆåŠ è½½ -->
    <script src="data.js"></script>
    <!-- ä¸»é€»è¾‘æ–‡ä»¶å»¶è¿ŸåŠ è½½ -->
    <script src="script.js" defer></script>

    <!-- Service Worker æ³¨å†Œ -->
    <script>
        // æ³¨å†Œ Service Worker ç”¨äºåå°æé†’
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('health-reminder-sw.js')
                .then(registration => {
                    console.log('Health Reminder Service Worker æ³¨å†ŒæˆåŠŸ:', registration);
                })
                .catch(error => {
                    console.log('Health Reminder Service Worker æ³¨å†Œå¤±è´¥:', error);
                });
        }
    </script>

    <!-- å¥åº·æé†’åŠŸèƒ½è„šæœ¬ï¼ˆæ”¯æŒåå°è¿è¡Œå’ŒéŸ³ä¹æé†’ï¼‰ -->
    <script>
        // å¥åº·æé†’ç®¡ç†å™¨ - æ”¯æŒåå°è¿è¡Œå’ŒéŸ³é¢‘æé†’
        (function() {
            'use strict';

            class HealthReminderManager {
                constructor() {
                    this.isActive = false;
                    this.breakInterval = null;
                    this.eyeCareInterval = null;
                    this.eyeCareTimer = null;
                    this.eyeCareDuration = 5 * 60 * 1000; // 5åˆ†é’Ÿçœ¼ä¿å¥æ“æ—¶é—´
                    this.isDoingEyeCare = false;
                    this.currentNotificationType = null;
                    this.backgroundModeEnabled = false;
                    this.audioManager = new AudioManager();
                    
                    this.init();
                }

                init() {
                    // ç­‰å¾…DOMåŠ è½½å®Œæˆ
                    if (document.readyState === 'loading') {
                        document.addEventListener('DOMContentLoaded', () => this.setupEventListeners());
                    } else {
                        this.setupEventListeners();
                    }
                }

                setupEventListeners() {
                    // è·å–DOMå…ƒç´ 
                    this.healthBtn = document.getElementById('healthReminderBtn');
                    this.notification = document.getElementById('healthNotification');
                    this.permissionBanner = document.getElementById('permissionBanner');
                    
                    // ç»‘å®šé€šçŸ¥å…ƒç´ 
                    this.notificationTitle = document.getElementById('notificationTitle');
                    this.notificationContent = document.getElementById('notificationContent');
                    this.notificationClose = document.getElementById('notificationClose');
                    this.notificationConfirm = document.getElementById('notificationConfirm');
                    this.notificationSnooze = document.getElementById('notificationSnooze');
                    
                    // æƒé™æŒ‰é’®
                    this.allowBackgroundBtn = document.getElementById('allowBackgroundBtn');
                    this.denyBackgroundBtn = document.getElementById('denyBackgroundBtn');

                    // æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨
                    if (!this.healthBtn || !this.notification) {
                        console.warn('å¥åº·æé†’åŠŸèƒ½å…ƒç´ æœªæ‰¾åˆ°');
                        return;
                    }

                    // ç»‘å®šäº‹ä»¶
                    this.healthBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.toggleHealthReminder();
                    });
                    
                    this.notificationClose.addEventListener('click', () => this.handleClose());
                    this.notificationConfirm.addEventListener('click', () => this.handleConfirm());
                    this.notificationSnooze.addEventListener('click', () => this.handleSnooze());
                    
                    // æƒé™è¯·æ±‚äº‹ä»¶
                    this.allowBackgroundBtn.addEventListener('click', () => this.enableBackgroundMode());
                    this.denyBackgroundBtn.addEventListener('click', () => this.hidePermissionBanner());

                    // è¯·æ±‚é€šçŸ¥æƒé™
                    this.requestNotificationPermission();

                    // ç›‘å¬é¡µé¢å¯è§æ€§å˜åŒ–
                    document.addEventListener('visibilitychange', () => this.handleVisibilityChange());

                    // ç›‘å¬ Service Worker æ¶ˆæ¯
                    if ('serviceWorker' in navigator) {
                        navigator.serviceWorker.addEventListener('message', (event) => {
                            this.handleServiceWorkerMessage(event.data);
                        });
                    }

                    // ä»localStorageæ¢å¤çŠ¶æ€
                    this.restoreState();
                }

                // è¯·æ±‚æµè§ˆå™¨é€šçŸ¥æƒé™
                async requestNotificationPermission() {
                    if ('Notification' in window && Notification.permission === 'default') {
                        try {
                            const permission = await Notification.requestPermission();
                            if (permission === 'granted') {
                                this.showPermissionBanner();
                            }
                        } catch (error) {
                            console.log('é€šçŸ¥æƒé™è¯·æ±‚å¤±è´¥:', error);
                        }
                    } else if ('Notification' in window && Notification.permission === 'granted') {
                        this.showPermissionBanner();
                    }
                }

                // æ˜¾ç¤ºæƒé™è¯·æ±‚æ¨ªå¹…
                showPermissionBanner() {
                    // æ£€æŸ¥æ˜¯å¦å·²ç»è¯·æ±‚è¿‡åå°æƒé™
                    const hasRequestedBackground = localStorage.getItem('healthReminderBackgroundRequested');
                    if (!hasRequestedBackground) {
                        setTimeout(() => {
                            this.permissionBanner.classList.add('show');
                        }, 2000);
                    }
                }

                // éšè—æƒé™è¯·æ±‚æ¨ªå¹…
                hidePermissionBanner() {
                    this.permissionBanner.classList.remove('show');
                    localStorage.setItem('healthReminderBackgroundRequested', 'true');
                }

                // å¯ç”¨åå°æ¨¡å¼
                async enableBackgroundMode() {
                    try {
                        // è¯·æ±‚æŒä¹…åŒ–é€šçŸ¥æƒé™
                        if ('Notification' in window && 'PersistentNotification' in window) {
                            // è¿™æ˜¯ä¸€ä¸ªå®éªŒæ€§APIï¼Œä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒ
                            console.log('å°è¯•å¯ç”¨æŒä¹…åŒ–é€šçŸ¥');
                        }

                        this.backgroundModeEnabled = true;
                        this.hidePermissionBanner();
                        
                        // å‘é€æ¶ˆæ¯ç»™ Service Worker
                        if ('serviceWorker' in navigator) {
                            navigator.serviceWorker.ready.then(registration => {
                                registration.active.postMessage({
                                    type: 'ENABLE_BACKGROUND',
                                    isActive: this.isActive
                                });
                            });
                        }

                        this.showNotification(
                            'background-enabled',
                            'åå°æé†’å·²å¯ç”¨',
                            `âœ… å¥åº·æé†’å°†åœ¨åå°è¿è¡Œ<br>âœ… å³ä½¿ç¦»å¼€é¡µé¢ä¹Ÿèƒ½æ”¶åˆ°æé†’<br>âœ… åŒ…å«éŸ³é¢‘æé†’åŠŸèƒ½`,
                            false
                        );

                        // 5ç§’åè‡ªåŠ¨å…³é—­
                        setTimeout(() => {
                            this.hideNotification();
                        }, 5000);

                    } catch (error) {
                        console.log('å¯ç”¨åå°æ¨¡å¼å¤±è´¥:', error);
                        this.hidePermissionBanner();
                    }
                }

                // å¤„ç†é¡µé¢å¯è§æ€§å˜åŒ–
                handleVisibilityChange() {
                    if (document.hidden) {
                        // é¡µé¢éšè—æ—¶ï¼Œå°†æé†’çŠ¶æ€åŒæ­¥åˆ° Service Worker
                        if ('serviceWorker' in navigator && this.backgroundModeEnabled) {
                            navigator.serviceWorker.ready.then(registration => {
                                registration.active.postMessage({
                                    type: 'SYNC_STATE',
                                    isActive: this.isActive,
                                    isDoingEyeCare: this.isDoingEyeCare
                                });
                            });
                        }
                    } else {
                        // é¡µé¢æ˜¾ç¤ºæ—¶ï¼Œä» Service Worker åŒæ­¥çŠ¶æ€
                        if ('serviceWorker' in navigator) {
                            navigator.serviceWorker.ready.then(registration => {
                                registration.active.postMessage({
                                    type: 'REQUEST_SYNC'
                                });
                            });
                        }
                    }
                }

                // å¤„ç† Service Worker æ¶ˆæ¯
                handleServiceWorkerMessage(data) {
                    switch (data.type) {
                        case 'BREAK_REMINDER':
                            this.showBreakReminder();
                            this.audioManager.playBreakSound();
                            break;
                        case 'EYE_CARE_REMINDER':
                            this.showEyeCareReminder();
                            this.audioManager.playEyeCareSound();
                            break;
                        case 'SYNC_RESPONSE':
                            if (data.state) {
                                this.isActive = data.state.isActive;
                                this.isDoingEyeCare = data.state.isDoingEyeCare;
                                this.updateButtonState(this.isActive);
                            }
                            break;
                    }
                }

                // åˆ‡æ¢å¥åº·æé†’çŠ¶æ€
                toggleHealthReminder() {
                    this.isActive = !this.isActive;
                    
                    if (this.isActive) {
                        this.startReminders();
                        this.updateButtonState(true);
                        this.saveState();
                        
                        // é€šçŸ¥ Service Worker
                        if ('serviceWorker' in navigator) {
                            navigator.serviceWorker.ready.then(registration => {
                                registration.active.postMessage({
                                    type: 'START_REMINDERS'
                                });
                            });
                        }
                    } else {
                        this.stopReminders();
                        this.updateButtonState(false);
                        this.saveState();
                        
                        // é€šçŸ¥ Service Worker
                        if ('serviceWorker' in navigator) {
                            navigator.serviceWorker.ready.then(registration => {
                                registration.active.postMessage({
                                    type: 'STOP_REMINDERS'
                                });
                            });
                        }
                    }
                }

                // æ›´æ–°æŒ‰é’®çŠ¶æ€
                updateButtonState(active) {
                    if (active) {
                        this.healthBtn.classList.add('active');
                        this.healthBtn.innerHTML = `
                            <span class="health-icon">
                                <i class="fas fa-heartbeat"></i>
                            </span>
                            <span>å¥åº·æé†’(å¼€å¯)</span>
                        `;
                    } else {
                        this.healthBtn.classList.remove('active');
                        this.healthBtn.innerHTML = `
                            <span class="health-icon">
                                <i class="fas fa-heartbeat"></i>
                            </span>
                            <span>å¥åº·æé†’</span>
                        `;
                    }
                }

                // å¼€å§‹æé†’
                startReminders() {
                    // ç«‹å³æ˜¾ç¤ºä¸€ä¸ªå¯åŠ¨æç¤º
                    setTimeout(() => {
                        this.showNotification(
                            'health-start',
                            'å¥åº·æé†’å·²å¼€å¯',
                            `âœ… æ¯30åˆ†é’Ÿæé†’æ´»åŠ¨èº«ä½“<br>âœ… æ¯2å°æ—¶æé†’åšçœ¼ä¿å¥æ“<br>âœ… åŒ…å«éŸ³é¢‘æé†’åŠŸèƒ½<br>âœ… æ”¯æŒåå°è¿è¡Œ`,
                            false
                        );
                        this.audioManager.playStartSound();
                    }, 500);

                    // 30åˆ†é’Ÿæ´»åŠ¨æé†’
                    this.breakInterval = setInterval(() => {
                        this.showBreakReminder();
                        this.audioManager.playBreakSound();
                        
                        // é€šçŸ¥ Service Worker
                        if ('serviceWorker' in navigator && this.backgroundModeEnabled) {
                            navigator.serviceWorker.ready.then(registration => {
                                registration.active.postMessage({
                                    type: 'SCHEDULE_BREAK'
                                });
                            });
                        }
                    }, 30 * 60 * 1000);

                    // 2å°æ—¶çœ¼ä¿å¥æ“æé†’
                    this.eyeCareInterval = setInterval(() => {
                        this.showEyeCareReminder();
                        this.audioManager.playEyeCareSound();
                        
                        // é€šçŸ¥ Service Worker
                        if ('serviceWorker' in navigator && this.backgroundModeEnabled) {
                            navigator.serviceWorker.ready.then(registration => {
                                registration.active.postMessage({
                                    type: 'SCHEDULE_EYE_CARE'
                                });
                            });
                        }
                    }, 2 * 60 * 60 * 1000);
                }

                // åœæ­¢æé†’
                stopReminders() {
                    if (this.breakInterval) {
                        clearInterval(this.breakInterval);
                        this.breakInterval = null;
                    }
                    if (this.eyeCareInterval) {
                        clearInterval(this.eyeCareInterval);
                        this.eyeCareInterval = null;
                    }
                    if (this.eyeCareTimer) {
                        clearTimeout(this.eyeCareTimer);
                        this.eyeCareTimer = null;
                    }
                    this.isDoingEyeCare = false;
                    this.currentNotificationType = null;
                    this.audioManager.stopAll();
                    this.hideNotification();
                }

                // æ˜¾ç¤ºæ´»åŠ¨æé†’
                showBreakReminder() {
                    this.showNotification(
                        'break',
                        'æ´»åŠ¨æé†’',
                        `ğŸš¶â€â™‚ï¸ æ‚¨å·²ç»åäº†30åˆ†é’Ÿäº†ï¼<br><br>
                         <strong>å»ºè®®æ´»åŠ¨ï¼š</strong><br>
                         â€¢ ç«™èµ·æ¥èµ°åŠ¨2-3åˆ†é’Ÿ<br>
                         â€¢ ä¼¸å±•è…°éƒ¨å’Œè‚©è†€<br>
                         â€¢ è¿œçœºçª—å¤–æ”¾æ¾çœ¼ç›<br>
                         â€¢ å–ä¸€æ¯æ°´è¡¥å……æ°´åˆ†<br><br>
                         <div class="audio-controls">
                            <button class="audio-btn" id="breakAudioBtn" title="æ’­æ”¾æé†’éŸ³ä¹">
                                <i class="fas fa-play"></i>
                            </button>
                            <div class="audio-info">
                                <div class="audio-title">æ´»åŠ¨æé†’éŸ³ä¹</div>
                                <div class="audio-status">ç‚¹å‡»æ’­æ”¾è½»æŸ”æé†’éŸ³ä¹</div>
                            </div>
                            <div class="volume-control">
                                <i class="fas fa-volume-up"></i>
                                <input type="range" class="volume-slider" id="breakVolumeSlider" min="0" max="100" value="50">
                            </div>
                        </div>`,
                        false
                    );

                    // ç»‘å®šéŸ³é¢‘æ§åˆ¶äº‹ä»¶
                    setTimeout(() => this.bindAudioControls('break'), 100);
                }

                // æ˜¾ç¤ºçœ¼ä¿å¥æ“æé†’
                showEyeCareReminder() {
                    this.isDoingEyeCare = true;
                    this.currentNotificationType = 'eye-care';
                    
                    this.showNotification(
                        'eye-care',
                        'çœ¼ä¿å¥æ“æ—¶é—´',
                        this.getEyeCareContent(),
                        true
                    );

                    // å¼€å§‹å€’è®¡æ—¶
                    this.startEyeCareTimer();

                    // ç»‘å®šéŸ³é¢‘æ§åˆ¶äº‹ä»¶
                    setTimeout(() => this.bindAudioControls('eye-care'), 100);
                }

                // è·å–çœ¼ä¿å¥æ“å†…å®¹
                getEyeCareContent() {
                    return `
                        <div class="eye-care-steps">
                            <h4>ğŸ‘ï¸ çœ¼ä¿å¥æ“æ­¥éª¤ï¼š</h4>
                            <ol>
                                <li><strong>æŒ‰æ‰å¤ªé˜³ç©´</strong> - é¡ºæ—¶é’ˆ8åœˆï¼Œé€†æ—¶é’ˆ8åœˆ</li>
                                <li><strong>æŒ‰æ‰å››ç™½ç©´</strong> - çœ¼çœ¶ä¸‹æ–¹ï¼ŒæŒ‰å‹8ç§’</li>
                                <li><strong>æŒ‰æ‰é£æ± ç©´</strong> - é¢ˆåä¸¤ä¾§ï¼ŒæŒ‰å‹8ç§’</li>
                                <li><strong>è¿œçœºè°ƒèŠ‚</strong> - è¿œçœ‹30ç§’ï¼Œè¿‘çœ‹30ç§’ï¼Œé‡å¤3æ¬¡</li>
                            </ol>
                        </div>
                        <div class="notification-timer">
                            <div class="timer-display" id="timerDisplay">05:00</div>
                            <div class="timer-label">çœ¼ä¿å¥æ“å€’è®¡æ—¶</div>
                        </div>
                        <div class="audio-controls">
                            <button class="audio-btn" id="eyeCareAudioBtn" title="æ’­æ”¾çœ¼ä¿å¥æ“éŸ³ä¹">
                                <i class="fas fa-play"></i>
                            </button>
                            <div class="audio-info">
                                <div class="audio-title">çœ¼ä¿å¥æ“éŸ³ä¹</div>
                                <div class="audio-status">ç‚¹å‡»æ’­æ”¾èˆ’ç¼“çœ¼ä¿å¥æ“éŸ³ä¹</div>
                            </div>
                            <div class="volume-control">
                                <i class="fas fa-volume-up"></i>
                                <input type="range" class="volume-slider" id="eyeCareVolumeSlider" min="0" max="100" value="50">
                            </div>
                        </div>`;
                }

                // ç»‘å®šéŸ³é¢‘æ§åˆ¶
                bindAudioControls(type) {
                    const audioBtn = document.getElementById(`${type}AudioBtn`);
                    const volumeSlider = document.getElementById(`${type}VolumeSlider`);
                    
                    if (audioBtn) {
                        audioBtn.addEventListener('click', () => {
                            this.audioManager.toggleAudio(type);
                            const icon = audioBtn.querySelector('i');
                            if (this.audioManager.isPlaying(type)) {
                                icon.className = 'fas fa-pause';
                                audioBtn.classList.add('playing');
                            } else {
                                icon.className = 'fas fa-play';
                                audioBtn.classList.remove('playing');
                            }
                        });
                    }

                    if (volumeSlider) {
                        volumeSlider.addEventListener('input', (e) => {
                            this.audioManager.setVolume(type, e.target.value / 100);
                        });
                    }
                }

                // å¼€å§‹çœ¼ä¿å¥æ“è®¡æ—¶å™¨
                startEyeCareTimer() {
                    let remainingTime = this.eyeCareDuration / 1000;
                    this.updateTimerDisplay(remainingTime);

                    this.eyeCareTimer = setInterval(() => {
                        remainingTime--;
                        this.updateTimerDisplay(remainingTime);

                        if (remainingTime <= 0) {
                            this.completeEyeCare();
                        }
                    }, 1000);
                }

                // æ›´æ–°è®¡æ—¶å™¨æ˜¾ç¤º
                updateTimerDisplay(seconds) {
                    const minutes = Math.floor(seconds / 60);
                    const secs = seconds % 60;
                    const display = document.getElementById('timerDisplay');
                    if (display) {
                        display.textContent = `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                    }

                    // æœ€å10ç§’æ·»åŠ è­¦å‘Šæ•ˆæœ
                    if (seconds <= 10 && seconds > 0) {
                        this.notification.style.animation = 'pulse 1s infinite';
                    } else {
                        this.notification.style.animation = '';
                    }
                }

                // å®Œæˆçœ¼ä¿å¥æ“
                completeEyeCare() {
                    clearInterval(this.eyeCareTimer);
                    this.eyeCareTimer = null;
                    this.isDoingEyeCare = false;
                    this.currentNotificationType = null;
                    this.audioManager.stopAudio('eye-care');

                    this.showNotification(
                        'eye-care-complete',
                        'çœ¼ä¿å¥æ“å®Œæˆï¼',
                        `ğŸ‰ å¤ªæ£’äº†ï¼æ‚¨çš„çœ¼ç›å¾—åˆ°äº†å……åˆ†ä¼‘æ¯<br><br>
                         <strong>æŠ¤çœ¼å°è´´å£«ï¼š</strong><br>
                         â€¢ ç»§ç»­ä¿æŒè‰¯å¥½çš„ç”¨çœ¼ä¹ æƒ¯<br>
                         â€¢ æ¯20åˆ†é’Ÿè¿œçœº20ç§’<br>
                         â€¢ ä¿æŒé€‚å½“çš„å±å¹•è·ç¦»<br>
                         â€¢ å®šæœŸæ£€æŸ¥è§†åŠ›`,
                        false
                    );

                    this.audioManager.playCompleteSound();

                    // 5ç§’åè‡ªåŠ¨å…³é—­
                    setTimeout(() => {
                        this.hideNotification();
                    }, 5000);
                }

                // æ˜¾ç¤ºé€šçŸ¥
                showNotification(type, title, content, isEyeCare = false) {
                    this.currentNotificationType = type;
                    
                    // è®¾ç½®æ ‡é¢˜
                    const titleSpan = this.notificationTitle.querySelector('span');
                    const icon = this.notificationTitle.querySelector('.notification-icon i');
                    
                    titleSpan.textContent = title;
                    
                    // è®¾ç½®å›¾æ ‡
                    if (type === 'eye-care' || type === 'eye-care-complete') {
                        icon.className = 'fas fa-eye';
                    } else if (type === 'break') {
                        icon.className = 'fas fa-walking';
                    } else if (type === 'health-start' || type === 'background-enabled') {
                        icon.className = 'fas fa-heartbeat';
                    }

                    // è®¾ç½®å†…å®¹
                    this.notificationContent.innerHTML = content;

                    // è®¾ç½®é€šçŸ¥æ ·å¼
                    this.notification.className = 'health-notification show';
                    if (type === 'eye-care') {
                        this.notification.classList.add('eye-care');
                    } else if (type === 'break') {
                        this.notification.classList.add('break');
                    }

                    // è®¾ç½®æŒ‰é’®çŠ¶æ€
                    if (isEyeCare) {
                        this.notificationSnooze.style.display = 'none';
                        this.notificationConfirm.innerHTML = '<i class="fas fa-check"></i> æˆ‘å·²å®Œæˆ';
                        this.notificationClose.disabled = true;
                        this.notificationClose.style.opacity = '0.5';
                        this.notificationClose.style.cursor = 'not-allowed';
                    } else {
                        this.notificationSnooze.style.display = 'block';
                        this.notificationConfirm.innerHTML = '<i class="fas fa-check"></i> ç¡®è®¤å®Œæˆ';
                        this.notificationClose.disabled = false;
                        this.notificationClose.style.opacity = '1';
                        this.notificationClose.style.cursor = 'pointer';
                    }

                    // åŒæ—¶æ˜¾ç¤ºæµè§ˆå™¨é€šçŸ¥
                    this.showBrowserNotification(title, content.replace(/<[^>]*>/g, ''), type);
                }

                // æ˜¾ç¤ºæµè§ˆå™¨é€šçŸ¥
                showBrowserNotification(title, content, type) {
                    if ('Notification' in window && Notification.permission === 'granted') {
                        const notification = new Notification(title, {
                            body: content,
                            icon: 'images/favicon.ico',
                            tag: type,
                            requireInteraction: type === 'eye-care',
                            silent: false // å…è®¸å£°éŸ³
                        });

                        // æ’­æ”¾ç³»ç»Ÿé€šçŸ¥å£°éŸ³ï¼ˆå¦‚æœæµè§ˆå™¨æ”¯æŒï¼‰
                        if (this.audioManager) {
                            this.audioManager.playNotificationSound();
                        }

                        if (type !== 'eye-care') {
                            setTimeout(() => {
                                notification.close();
                            }, 5000);
                        }

                        // ç‚¹å‡»é€šçŸ¥æ—¶èšç„¦åˆ°é¡µé¢
                        notification.onclick = () => {
                            window.focus();
                            notification.close();
                        };
                    }
                }

                // éšè—é€šçŸ¥
                hideNotification() {
                    this.notification.classList.remove('show');
                    this.currentNotificationType = null;
                }

                // å¤„ç†å…³é—­æŒ‰é’®
                handleClose() {
                    if (!this.isDoingEyeCare) {
                        this.hideNotification();
                        this.audioManager.stopAll();
                    }
                }

                // å¤„ç†ç¡®è®¤å®Œæˆ
                handleConfirm() {
                    if (this.isDoingEyeCare) {
                        this.completeEyeCare();
                    } else {
                        this.hideNotification();
                        this.audioManager.stopAll();
                    }
                }

                // å¤„ç†ç¨åæé†’
                handleSnooze() {
                    if (!this.isDoingEyeCare) {
                        this.hideNotification();
                        this.audioManager.stopAll();
                        // 5åˆ†é’Ÿåå†æ¬¡æé†’
                        setTimeout(() => {
                            this.showBreakReminder();
                            this.audioManager.playBreakSound();
                        }, 5 * 60 * 1000);
                    }
                }

                // ä¿å­˜çŠ¶æ€åˆ°localStorage
                saveState() {
                    localStorage.setItem('healthReminderActive', this.isActive.toString());
                    localStorage.setItem('healthReminderBackground', this.backgroundModeEnabled.toString());
                }

                // ä»localStorageæ¢å¤çŠ¶æ€
                restoreState() {
                    const saved = localStorage.getItem('healthReminderActive');
                    const backgroundSaved = localStorage.getItem('healthReminderBackground');
                    
                    if (saved === 'true') {
                        this.isActive = true;
                        this.updateButtonState(true);
                        this.startReminders();
                    }
                    
                    if (backgroundSaved === 'true') {
                        this.backgroundModeEnabled = true;
                    }
                }
            }

            // éŸ³é¢‘ç®¡ç†å™¨
            class AudioManager {
                constructor() {
                    this.audioContext = null;
                    this.sounds = {
                        start: null,
                        break: null,
                        eyeCare: null,
                        complete: null,
                        notification: null
                    };
                    this.currentAudio = {
                        break: null,
                        eyeCare: null
                    };
                    this.volumes = {
                        break: 0.5,
                        eyeCare: 0.5
                    };
                    this.init();
                }

                init() {
                    try {
                        // åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡
                        window.AudioContext = window.AudioContext || window.webkitAudioContext;
                        this.audioContext = new AudioContext();
                        
                        // ç”ŸæˆéŸ³é¢‘
                        this.generateSounds();
                    } catch (error) {
                        console.log('éŸ³é¢‘åˆå§‹åŒ–å¤±è´¥:', error);
                    }
                }

                // ç”ŸæˆéŸ³é¢‘ï¼ˆä½¿ç”¨ Web Audio APIï¼‰
                generateSounds() {
                    if (!this.audioContext) return;

                    // å¼€å§‹æç¤ºéŸ³
                    this.sounds.start = this.createTone(523.25, 0.1); // C5
                    
                    // æ´»åŠ¨æé†’éŸ³
                    this.sounds.break = this.createMelody([523.25, 659.25, 783.99], 0.2); // C5, E5, G5
                    
                    // çœ¼ä¿å¥æ“éŸ³ä¹ï¼ˆèˆ’ç¼“çš„æ—‹å¾‹ï¼‰
                    this.sounds.eyeCare = this.createRelaxingMusic();
                    
                    // å®Œæˆæç¤ºéŸ³
                    this.sounds.complete = this.createMelody([783.99, 659.25, 523.25], 0.15); // G5, E5, C5
                    
                    // é€šçŸ¥æç¤ºéŸ³
                    this.sounds.notification = this.createTone(880, 0.05); // A5
                }

                // åˆ›å»ºå•éŸ³
                createTone(frequency, duration) {
                    const oscillator = this.audioContext.createOscillator();
                    const gainNode = this.audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(this.audioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    oscillator.type = 'sine';
                    
                    gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + duration);
                    
                    return { oscillator, gainNode, duration };
                }

                // åˆ›å»ºæ—‹å¾‹
                createMelody(frequencies, noteDuration) {
                    return frequencies.map(frequency => this.createTone(frequency, noteDuration));
                }

                // åˆ›å»ºèˆ’ç¼“çš„çœ¼ä¿å¥æ“éŸ³ä¹
                createRelaxingMusic() {
                    // è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¾ªç¯éŸ³ä¹ç”Ÿæˆå™¨
                    const melody = [
                        261.63, 293.66, 329.63, 349.23, 392.00, 349.23, 329.63, 293.66, // C4, D4, E4, F4, G4, F4, E4, D4
                        261.63, 293.66, 329.63, 392.00, 440.00, 392.00, 329.63, 293.66  // C4, D4, E4, G4, A4, G4, E4, D4
                    ];
                    
                    return this.createMelody(melody, 0.5);
                }

                // æ’­æ”¾éŸ³é¢‘
                playSound(soundType) {
                    if (!this.audioContext || !this.sounds[soundType]) return;
                    
                    // æ¢å¤éŸ³é¢‘ä¸Šä¸‹æ–‡ï¼ˆå¦‚æœè¢«æš‚åœï¼‰
                    if (this.audioContext.state === 'suspended') {
                        this.audioContext.resume();
                    }
                    
                    const sound = this.sounds[soundType];
                    
                    if (Array.isArray(sound)) {
                        // æ’­æ”¾æ—‹å¾‹
                        sound.forEach((note, index) => {
                            setTimeout(() => {
                                this.playNote(note);
                            }, index * 200);
                        });
                    } else {
                        // æ’­æ”¾å•éŸ³
                        this.playNote(sound);
                    }
                }

                // æ’­æ”¾éŸ³ç¬¦
                playNote(note) {
                    const oscillator = this.audioContext.createOscillator();
                    const gainNode = this.audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(this.audioContext.destination);
                    
                    oscillator.frequency.value = note.oscillator.frequency.value;
                    oscillator.type = note.oscillator.type;
                    
                    gainNode.gain.setValueAtTime(0.3, this.audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, this.audioContext.currentTime + note.duration);
                    
                    oscillator.start(this.audioContext.currentTime);
                    oscillator.stop(this.audioContext.currentTime + note.duration);
                }

                // æ’­æ”¾å¾ªç¯éŸ³ä¹
                playLoopingAudio(type, soundArray) {
                    if (this.currentAudio[type]) {
                        this.stopAudio(type);
                    }
                    
                    let currentIndex = 0;
                    const playNext = () => {
                        if (!this.currentAudio[type]) return;
                        
                        this.playNote(soundArray[currentIndex]);
                        currentIndex = (currentIndex + 1) % soundArray.length;
                        
                        this.currentAudio[type] = setTimeout(playNext, 200);
                    };
                    
                    playNext();
                }

                // æ’­æ”¾å¼€å§‹éŸ³
                playStartSound() {
                    this.playSound('start');
                }

                // æ’­æ”¾æ´»åŠ¨æé†’éŸ³
                playBreakSound() {
                    this.playSound('break');
                }

                // æ’­æ”¾çœ¼ä¿å¥æ“éŸ³ä¹
                playEyeCareSound() {
                    this.playLoopingAudio('eye-care', this.sounds.eyeCare);
                }

                // æ’­æ”¾å®ŒæˆéŸ³
                playCompleteSound() {
                    this.playSound('complete');
                }

                // æ’­æ”¾é€šçŸ¥éŸ³
                playNotificationSound() {
                    this.playSound('notification');
                }

                // åˆ‡æ¢éŸ³é¢‘æ’­æ”¾
                toggleAudio(type) {
                    if (this.currentAudio[type]) {
                        this.stopAudio(type);
                    } else {
                        if (type === 'break') {
                            this.playLoopingAudio('break', this.sounds.break);
                        } else if (type === 'eye-care') {
                            this.playEyeCareSound();
                        }
                    }
                }

                // æ£€æŸ¥æ˜¯å¦æ­£åœ¨æ’­æ”¾
                isPlaying(type) {
                    return this.currentAudio[type] !== null;
                }

                // è®¾ç½®éŸ³é‡
                setVolume(type, volume) {
                    this.volumes[type] = volume;
                    // å®é™…çš„éŸ³é‡æ§åˆ¶éœ€è¦æ›´å¤æ‚çš„å®ç°
                }

                // åœæ­¢æŒ‡å®šéŸ³é¢‘
                stopAudio(type) {
                    if (this.currentAudio[type]) {
                        clearTimeout(this.currentAudio[type]);
                        this.currentAudio[type] = null;
                    }
                }

                // åœæ­¢æ‰€æœ‰éŸ³é¢‘
                stopAll() {
                    Object.keys(this.currentAudio).forEach(type => {
                        this.stopAudio(type);
                    });
                }
            }

            // åˆå§‹åŒ–å¥åº·æé†’ç®¡ç†å™¨
            window.healthReminderManager = new HealthReminderManager();

            // æ·»åŠ è„‰å†²åŠ¨ç”»
            const style = document.createElement('style');
            style.textContent = `
                @keyframes pulse {
                    0%, 100% { transform: scale(1); }
                    50% { transform: scale(1.02); }
                }
            `;
            document.head.appendChild(style);

        })();
    </script>

    <!-- æ€§èƒ½ç›‘æ§ï¼ˆå¯é€‰ï¼‰ -->
    <script>
        // é¡µé¢åŠ è½½æ€§èƒ½ç›‘æ§
        window.addEventListener('load', () => {
            if ('performance' in window) {
                const perfData = performance.getEntriesByType('navigation')[0];
                console.log('é¡µé¢åŠ è½½æ—¶é—´:', perfData.loadEventEnd - perfData.fetchStart, 'ms');
            }
        });
    </script>
  
</body>
</html>
